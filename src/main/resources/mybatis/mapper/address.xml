<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.webteam1.oti.dao.AddressDao">
	<insert id="insert" parameterType="Address">
		<selectKey keyProperty="address_no" resultType="int" order="BEFORE">
	         select address_seq.nextval from dual
      	</selectKey>
      	
		insert into address(
	      	address_no, address_receiver, address_roadaddress, address_jibunaddress, address_extraaddress, address_detail, address_isdefault, users_users_id, address_createddate, deliveryrequest, users_phone
		)
		values(
			#{address_no}, #{address_receiver}, #{address_roadAddress}, #{address_jibunAddress}, #{address_extraAddress}, #{address_detail}, #{address_isdefault}, 
			'space5', to_char(sysdate,'yyyy.mm.dd hh24:mi:ss'), #{deliveryRequest}, #{users_phone}
		)
	</insert>
	
	<update id="update" parameterType="Address">
		update address set address_receiver=#{address_no}, address_roadaddress=#{address_roadAddress}, address_jibunaddress=#{address_jibunAddress}, address_extraaddress=#{address_extraAddress},
						  address_detail=#{address_detail}, address_isdefault=#{address_isdefault}, address_modifieddate=to_char(sysdate,'yyyy.mm.dd hh24:mi:ss'), deliveryrequest=#{deliveryRequest}, users_phone=#{users_phone}
		where address_no = #{address_no}
	</update>
	
	<select id="selectByPage" parameterType="Pager" resultType="Address">
   		<![CDATA[
       select rnum, product_no, product_name, product_price, product_imgFile, product_img
		 from (
		    select rownum as rnum, product_no, product_name, product_price, product_imgFile, product_img
		    from(
		        select product_no, product_name, product_price, product_imgFile, product_img
		        from product
		        order by product_no desc
		    )
		    where rownum <= #{endRowNo}
		 )
		 where rnum >= #{startRowNo}
		 ]]>
  	</select>
</mapper>